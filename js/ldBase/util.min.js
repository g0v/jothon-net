var x$;function import$(e,t){var n,r={}.hasOwnProperty;for(n in t)r.call(t,n)&&(e[n]=t[n]);return e}(x$=angular.module("ldBase")).filter("prettyColorHex",function(){return function(e){var t;return/rgba?/.exec(e)?"#"+[(t=/rgba?\(([^,]+),([^,]+),([^,]+)(?:,([^,]+))?\)/.exec(e))[1],t[2],t[3],t[4]].map(function(e,t){var n;return e&&(n=+e,~e.indexOf("%")?n=Math.round(2.55*+e.replace("%","")).toString(16):+e<1&&(n=.01*Math.round(100*+e)+""),4<(n=n.length<2?"0"+n:n).length&&(n=n.substring(0,4)),3===t?" / "+n:n)}).join(""):e}}),x$.filter("nicedate",function(){return function(e){e=new Date(e);return e.getYear()+1900+"/"+(e.getMonth()+1)+"/"+e.getDate()}}),x$.filter("nicedatetime",function(){return function(e){var t=function(e){return(e<10?"0":"")+e},e=new Date(e);return e.getYear()+1900+"/"+t(e.getMonth()+1)+"/"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())}}),x$.service("gautil",["$rootScope"].concat(function(e){return{track:function(e,t,n,r){if("undefined"!=typeof ga&&null!==ga)return ga("send","event",e,t,n,r)}}})),x$.service("initWrap",["$rootScope"].concat(function(e){return function(){var t=function(e){return(t.list||(t.list=[])).push(e),import$(e,{promise:{},failed:function(e){var t,n,r,i,o;for(null==e&&(e="default"),n=[],r=1,i=arguments.length;r<i;++r)n.push(arguments[r]);if(t=n,this.promise[e])return o=this.promise[e].rej,this.promise[e]=null,o.apply(null,t)},finish:function(e){var t,n,r,i,o;for(null==e&&(e="default"),n=[],r=1,i=arguments.length;r<i;++r)n.push(arguments[r]);if(t=n,this.promise[e])return o=this.promise[e].res,this.promise[e]=null,o.apply(null,t)},block:function(n){var r=this;return null==n&&(n="default"),new Promise(function(e,t){return r.promise[n]={res:e,rej:t}})}})};return t.run=function(){return(this.list||(this.list=[])).map(function(e){return e.init()})},t}})),x$.directive("ngModal",["$compile","$timeout"].concat(function(e,u){return{restrict:"A",scope:{model:"=ngModel",config:"=config"},link:function(r,n,e,t){var i,o=r.config||{};return r.model.ctrl=i={promise:null,focus:function(){return u(function(){var e=n.find("input[tabindex='1']");if(e.length)return e.focus()},0)},toggle:function(e,t,n){if(null==n&&(n="done"),t&&(this.value=t),(null==e||!!this.toggled!=!!e)&&(this.toggled=null!=e?e:!this.toggled,this.toggled&&this.focus(),!this.toggled)&&i.promise)return r.model.action(n)},toggled:null,value:null,reset:function(){return this.value=""},init:function(){return this.reset(),n.on("keydown",function(e){var t=e.keyCode||e.which;if(13===t)return t=+e.target.getAttribute("tabindex")+1,(e=n.find("input[tabindex='"+t+"']"))&&e.length?e[0].focus():(o.dismissOnEnter&&r.$apply(function(){return r.model.action("done")}),null!=o.finish?o.finish():void 0)})}},r.model.action=function(e){if("done"===e&&(r.model.value=i.value),i.toggle(!1,null,e),i.promise)return"done"===e?i.promise.res(i.value):i.promise.rej(e),i.promise=null},r.model.prompt=function(e){return i.toggle(!0,e),new Promise(function(e,t){return i.promise={res:e,rej:t}})},r.model.ctrl.init()}}})),x$.directive("ngIonSlider",["$compile"].concat(function(e){return{restrict:"A",scope:{model:"=ngValue",config:"=config",switch:"=ngSwitch"},link:function(o,u,l,e){var a;return u[0].addEventListener("keyup",function(){if(u[0].value!==o.model)return o.$apply(function(){return o.model=u[0].value||0})}),u[0].addEventListener("change",function(){if(u[0].value!==o.model)return o.$apply(function(){return o.model=u[0].value||0})}),null!=l.ngSwitch&&null==o.switch&&(o.switch=null==l.defaultSwitch||!0===l.defaultSwitch),o.$watch("model",function(e){return u[0].value=e||0}),a=!1,o.$watch("switch",function(e,t){var n,r,i;return(e=l.ngSwitch?e:null==l.defaultSwitch||"true"===l.defaultSwitch)&&!a&&(a=!0,n=o.config||{},(r="double"===n.type)&&!Array.isArray(o.model)&&(o.model=[0,100]),o.$watch("config",function(e){return i.update(e)}),o.$watch("model",function(e){return r?(i.result.from!==e[0]&&i.update({from:e[0]}),i.result.to!==e[1]&&i.update({to:e[1]})):i.result.from!==+e&&i.update({from:e}),u.removeAttr("readonly")}),$(u).ionRangeSlider(import$(import$({},n),{onChange:function(e){return o.$apply(function(){if(r){if(o.model[0]!==e.from&&(o.model[0]=e.from),o.model[1]!==e.to)return o.model[1]=e.to}else if(o.model!==e.from)return o.model=e.from})}})),i=$(u).data("ionRangeSlider")),e?(u.addClass("irs-hidden-input"),u.attr("readonly",!0),u.parent().removeClass("input")):(u.removeClass("irs-hidden-input"),u.removeAttr("readonly"),u.parent().addClass("input"))})}}})),x$.directive("readby",["$compile"].concat(function(e){return{scope:{readby:"&readby",encoding:"@encoding",askencoding:"&askencoding",multiple:"@multiple"},link:function(i,o,u,e){var l=i.readby(),t=i.askencoding();return o.bind("change",function(r){var e=function(){var e,t,n=r.target.files;if(n.length)return u.multiple?(e=function(r){return new Promise(function(e,t){var n=new FileReader;return n.onload=function(){return e({result:n.result,file:r})},u.asdataurl?n.readAsDataURL(r):i.encoding?n.readAsText(r,i.encoding):n.readAsBinaryString(r)})},e=Array.from(n).map(e),Promise.all(e).then(function(e){return i.$apply(function(){return l(e)}),o.val("")})):((t=new FileReader).onload=function(){return i.$apply(function(){return l(t.result,n[0])}),o.val("")},null!=u.asdataurl?t.readAsDataURL(n[0]):null!=u.asarraybuffer?t.readAsArrayBuffer(n[0]):i.encoding?t.readAsText(n[0],i.encoding):t.readAsBinaryString(n[0]))};return i.$apply(function(){return t?t(e):e()})})}}})),x$.directive("ngGradient",["$compile"].concat(function(e){return{restrict:"A",scope:{model:"=ngValue",config:"=config"},link:function(o,u,e,t){var r,l,a,i,d,c;return o.idx=null,r=u[0].querySelector(".ldColorPicker"),l=new ldColorPicker(null,{class:"text-input no-palette flat"}),(r=l.node).style.display="none",d=!(i=a=!1),o.$watch("model",c=function(){if(o.model)return o.gradient=["linear-gradient(90deg,",o.model.colors.map(function(e){return e.value+" "+100*e.pos+"%"}).join(","),")"].join(""),u[0].querySelector(".gradient-inner").style.background=o.gradient}),l.on("change",function(e){return o.$apply(function(){if(null!=o.idx&&o.model)return o.model.colors[o.idx].value=e,c()})}),u[0].addEventListener("mouseup",function(n){return o.$apply(function(){var e,t;if(d=!0,i&&!a&&null!=o.idx)return e=n.target.getBoundingClientRect(),u[0].getBoundingClientRect(),(t=o.lastidx!==o.idx||"block"!==r.style.display)&&setTimeout(function(){return l.toggle(t)},0),r.style.top=e.bottom+15+document.body.scrollTop+"px",r.style.left=e.left-15+document.body.scrollLeft+"px",n.stopPropagation(),n.preventDefault()})}),u[0].addEventListener("click",function(t){return o.$apply(function(){var e;if(!(a||t.target!==u[0]&&t.target!==u[0].querySelector(".gradient-inner")))return e=u[0].getBoundingClientRect(),0<=(e=(e=(t.clientX-e.left)/e.width)<=1?e:1)||(e=0),o.model?(o.model.colors.push({value:"#000000",pos:e}),o.model.colors.sort(function(e,t){return e.pos-t.pos}),c(),l.toggle(!1)):void 0})}),window.addEventListener("mousedown",function(e){return o.$apply(function(){if(i=a=!1,e.target.parentNode===u[0])return d=!1,o.lastidx=o.idx,o.idx=Array.from(e.target.parentNode.childNodes).filter(function(e){return e.getAttribute&&/tick/.exec(e.getAttribute("class"))}).indexOf(e.target),o.idx<0?o.idx=null:(i=!0,e.preventDefault(),e.stopPropagation())})}),window.addEventListener("mousemove",function(i){return o.$apply(function(){var e,t,n,r;if(a=!0,e=u[0].getBoundingClientRect(),0<=(t=(t=(i.clientX-e.left)/e.width)<=1?t:1)||(t=0),n=Math.abs(i.clientY-(e.top+e.height/2)),r=i.buttons||i.button,!d&&r&&null!=o.idx)return l.toggle(!1),n>e.height/2+60?(o.model&&o.model.colors.splice(o.idx,1),o.idx=null,c()):o.model?(0<o.idx&&o.model.colors[o.idx-1].pos>t&&(t=o.model.colors[o.idx-1].pos),o.idx<o.model.colors.length-1&&o.model.colors[o.idx+1].pos<t&&(t=o.model.colors[o.idx+1].pos),o.model.colors[o.idx].pos=t,c()):void 0})}),c()}}})),x$.directive("ngClipboard",["$compile"].concat(function(e){return{restrict:"A",scope:{},link:function(e,t,n,r){var i=new Clipboard(t[0],{target:function(){return document.querySelector(n.target)}}),o=document.createElement("div");return o.setAttribute("class","hover-tip "+(n.dir||"top")),t[0].appendChild(o),i.on("success",function(){return t.addClass("copied"),o.innerText="copied",setTimeout(function(){return t.removeClass("copied")},1e3)}),i.on("error",function(){return t.addClass("copied"),o.innerText="Press Ctrl+C to Copy",setTimeout(function(){return t.removeClass("copied")},1e3)})}}})),x$.directive("ngDrop",["$compile"].concat(function(e){return{restrict:"A",scope:{swap:"&swap"},link:function(e,t,n,r){var i,o;return n.swap&&(i=e.swap()),o=function(e){return e.getAttribute("draggable")?e:e.parentNode},t[0].addEventListener("dragenter",function(e){return e.preventDefault()}),t[0].addEventListener("dragover",function(e){return e.preventDefault(),e.dataTransfer.dropEffect="move"}),t[0].addEventListener("dragstart",function(e){var t=o(e.target),t=Array.from(t.parentNode.querySelectorAll("*[draggable=true]")).indexOf(t);return e.dataTransfer.setData("text/plain",t)}),t[0].addEventListener("drop",function(e){var t=o(e.target),e=+e.dataTransfer.getData("text"),t=Array.from(t.parentNode.querySelectorAll("*[draggable=true]")).indexOf(t);if(0<=e&&0<=t&&i)return i(e,t)})}}})),x$.directive("ngPaypal",["$compile","global","$timeout","gautil"].concat(function(e,l,a,d){return{restrict:"A",scope:{model:"=ngModel",trackid:"@trackid",type:"@type",id:"@itemid",price:"@price",format:"@format"},link:function(r,n,e,t){var i,o,u=document.createElement("div");return u.id="paypal-btn-"+Math.random().toString().substring(2),u.setAttribute("class","paypal-btn-inner"),(i=document.createElement("div")).id="paypal-btn-"+Math.random().toString().substring(2)+"-loader",i.setAttribute("class","ld ld-ball ld-flip"),n[0].appendChild(u),n[0].appendChild(i),n.addClass("ld ld-over-inverse running"),r.paid=!1,r.$watch("model.list",function(e,t){if(e!==t&&e&&e.length)return(t=e.filter(function(e){return e.type===r.type&&e.item===r.id}).length)?n.addClass("paid"):n.removeClass("paid"),r.paid=!!t},!0),n.on("click",function(){if(r.paid)return r.model.paid({trackid:r.trackid,id:r.id,type:r.type,price:r.price,format:r.format})}),(o={init:function(){if(!this.inited)return"undefined"==typeof paypal||null===paypal?a(function(){return o.init()},1e3):(this.inited=!0,paypal.Button.render({env:l.production?"production":"sandbox",style:{size:"responsive"},payment:function(t,n){return d.track(r.trackid,"pay-button","click"),paypal.request.post("/d/create-payment/",{type:r.type,id:r.id},{headers:{"X-CSRF-Token":l.csrfToken}}).then(function(e){return t(e.paymentID)}).catch(function(e){return n(e)})},onAuthorize:function(e){return paypal.request.post("/d/execute-payment/",((e={paymentID:e.paymentID,payerID:e.payerID}).type=r.type,e.id=r.id,e),{headers:{"X-CSRF-Token":l.csrfToken}}).then(function(e){return r.$apply(function(){if(null!=r.model.paid)return r.model.paid({trackid:r.trackid,id:r.id,type:r.type,price:r.price,format:r.format})}),d.track(r.trackid,"paid",r.format||"",1.99),null}).catch(function(e){return console.log(e),alert("Something wrong in the payment process. please try again.")})}},u.id).then(function(){return n.removeClass("running")}))}}).init()}}}));