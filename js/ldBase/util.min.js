function import$(e,t){var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}var x$,slice$=[].slice;(x$=angular.module("ldBase")).filter("prettyColorHex",function(){return function(e){var t;return/rgba?/.exec(e)?(t=/rgba?\(([^,]+),([^,]+),([^,]+)(?:,([^,]+))?\)/.exec(e),"#"+[t[1],t[2],t[3],t[4]].map(function(e,t){var n;return e?(n=+e,~e.indexOf("%")?n=Math.round(2.55*+e.replace("%","")).toString(16):+e<1&&(n=.01*Math.round(100*+e)+""),n.length<2&&(n="0"+n),n.length>4&&(n=n.substring(0,4)),3===t&&(n=" / "+n),n):e}).join("")):e}}),x$.filter("nicedate",function(){return function(e){var t;return(t=new Date(e)).getYear()+1900+"/"+(t.getMonth()+1)+"/"+t.getDate()}}),x$.filter("nicedatetime",function(){return function(e){var t,n,r,i,o,l,a,u;return t=function(e){return(e<10?"0":"")+e},n=new Date(e),r=n.getYear()+1900,i=t(n.getMonth()+1),o=t(n.getDate()),l=t(n.getHours()),a=t(n.getMinutes()),u=t(n.getSeconds()),r+"/"+i+"/"+o+" "+l+":"+a+":"+u}}),x$.service("gautil",["$rootScope"].concat(function(e){return{track:function(e,t,n,r){if("undefined"!=typeof ga&&null!==ga)return ga("send","event",e,t,n,r)}}})),x$.service("initWrap",["$rootScope"].concat(function(e){return function(){var e;return e=function(t){return(e.list||(e.list=[])).push(t),import$(t,{promise:{},failed:function(e){var t,n;if(null==e&&(e="default"),t=slice$.call(arguments,1),this.promise[e])return n=this.promise[e].rej,this.promise[e]=null,n.apply(null,t)},finish:function(e){var t,n;if(null==e&&(e="default"),t=slice$.call(arguments,1),this.promise[e])return n=this.promise[e].res,this.promise[e]=null,n.apply(null,t)},block:function(e){var t=this;return null==e&&(e="default"),new Promise(function(n,r){return t.promise[e]={res:n,rej:r}})}})},e.run=function(){return(this.list||(this.list=[])).map(function(e){return e.init()})},e}})),x$.directive("ngModal",["$compile","$timeout"].concat(function(e,t){return{restrict:"A",scope:{model:"=ngModel",config:"=config"},link:function(e,n,r,i){var o,l;return o=e.config||{},e.model.ctrl=l={promise:null,focus:function(){return t(function(){var e;if((e=n.find("input[tabindex='1']")).length)return e.focus()},0)},toggle:function(t,n,r){if(null==r&&(r="done"),n&&(this.value=n),(null==t||!!this.toggled!=!!t)&&(this.toggled=null!=t?t:!this.toggled,this.toggled&&this.focus(),!this.toggled&&l.promise))return e.model.action(r)},toggled:null,value:null,reset:function(){return this.value=""},init:function(){return this.reset(),n.on("keydown",function(t){var r,i;if(13===(t.keyCode||t.which))return r=+t.target.getAttribute("tabindex")+1,(i=n.find("input[tabindex='"+r+"']"))&&i.length?i[0].focus():(o.dismissOnEnter&&e.$apply(function(){return e.model.action("done")}),null!=o.finish?o.finish():void 0)})}},e.model.action=function(t){if("done"===t&&(e.model.value=l.value),l.toggle(!1,null,t),l.promise)return"done"===t?l.promise.res(l.value):l.promise.rej(t),l.promise=null},e.model.prompt=function(e){return l.toggle(!0,e),new Promise(function(e,t){return l.promise={res:e,rej:t}})},e.model.ctrl.init()}}})),x$.directive("ngIonSlider",["$compile"].concat(function(e){return{restrict:"A",scope:{model:"=ngValue",config:"=config",switch:"=ngSwitch"},link:function(e,t,n,r){var i;return t[0].addEventListener("keyup",function(){if(t[0].value!==e.model)return e.$apply(function(){return e.model=t[0].value||0})}),t[0].addEventListener("change",function(){if(t[0].value!==e.model)return e.$apply(function(){return e.model=t[0].value||0})}),null!=n.ngSwitch&&null==e.switch&&(e.switch=null==n.defaultSwitch||!0===n.defaultSwitch),e.$watch("model",function(e){return t[0].value=e||0}),i=!1,e.$watch("switch",function(r,o){var l,a,u;return n.ngSwitch||(r=null==n.defaultSwitch||"true"===n.defaultSwitch),r&&!i&&(i=!0,l=e.config||{},(a="double"===l.type)&&!Array.isArray(e.model)&&(e.model=[0,100]),e.$watch("config",function(e){return u.update(e)}),e.$watch("model",function(e){return a?(u.result.from!==e[0]&&u.update({from:e[0]}),u.result.to!==e[1]&&u.update({to:e[1]})):u.result.from!==+e&&u.update({from:e}),t.removeAttr("readonly")}),$(t).ionRangeSlider(import$(import$({},l),{onChange:function(t){return e.$apply(function(){if(a){if(e.model[0]!==t.from&&(e.model[0]=t.from),e.model[1]!==t.to)return e.model[1]=t.to}else if(e.model!==t.from)return e.model=t.from})}})),u=$(t).data("ionRangeSlider")),r?(t.addClass("irs-hidden-input"),t.attr("readonly",!0),t.parent().removeClass("input")):(t.removeClass("irs-hidden-input"),t.removeAttr("readonly"),t.parent().addClass("input"))})}}})),x$.directive("readby",["$compile"].concat(function(e){return{scope:{readby:"&readby",encoding:"@encoding",askencoding:"&askencoding",multiple:"@multiple"},link:function(e,t,n,r){var i,o;return i=e.readby(),o=e.askencoding(),t.bind("change",function(r){var l;return l=function(){var o,l,a,u;if((o=r.target.files).length)return n.multiple?(l=function(t){return new Promise(function(r,i){var o;return o=new FileReader,o.onload=function(){return r({result:o.result,file:t})},n.asdataurl?o.readAsDataURL(t):e.encoding?o.readAsText(t,e.encoding):o.readAsBinaryString(t)})},a=Array.from(o).map(function(e){return l(e)}),Promise.all(a).then(function(n){return e.$apply(function(){return i(n)}),t.val("")})):(u=new FileReader,u.onload=function(){return e.$apply(function(){return i(u.result,o[0])}),t.val("")},null!=n.asdataurl?u.readAsDataURL(o[0]):null!=n.asarraybuffer?u.readAsArrayBuffer(o[0]):e.encoding?u.readAsText(o[0],e.encoding):u.readAsBinaryString(o[0]))},e.$apply(function(){return o?o(l):l()})})}}})),x$.directive("ngGradient",["$compile"].concat(function(e){return{restrict:"A",scope:{model:"=ngValue",config:"=config"},link:function(e,t,n,r){var i,o,l,a,u,d;return e.idx=null,i=t[0].querySelector(".ldColorPicker"),o=new ldColorPicker(null,{class:"text-input no-palette flat"}),i=o.node,i.style.display="none",l=!1,a=!1,u=!0,d=function(){if(e.model)return e.gradient=["linear-gradient(90deg,",e.model.colors.map(function(e){return e.value+" "+100*e.pos+"%"}).join(","),")"].join(""),t[0].querySelector(".gradient-inner").style.background=e.gradient},e.$watch("model",function(){return d()}),o.on("change",function(t){return e.$apply(function(){if(null!=e.idx&&e.model)return e.model.colors[e.idx].value=t,d()})}),t[0].addEventListener("mouseup",function(n){return e.$apply(function(){var r,d;if(u=!0,a&&!l&&null!=e.idx)return r=n.target.getBoundingClientRect(),t[0].getBoundingClientRect(),(d=e.lastidx!==e.idx||"block"!==i.style.display)&&setTimeout(function(){return o.toggle(d)},0),i.style.top=r.bottom+15+document.body.scrollTop+"px",i.style.left=r.left-15+document.body.scrollLeft+"px",n.stopPropagation(),n.preventDefault()})}),t[0].addEventListener("click",function(n){return e.$apply(function(){var r,i;if(!(l||n.target!==t[0]&&n.target!==t[0].querySelector(".gradient-inner")))return r=t[0].getBoundingClientRect(),(i=(n.clientX-r.left)/r.width)<=1||(i=1),i>=0||(i=0),e.model?(e.model.colors.push({value:"#000000",pos:i}),e.model.colors.sort(function(e,t){return e.pos-t.pos}),d(),o.toggle(!1)):void 0})}),window.addEventListener("mousedown",function(n){return e.$apply(function(){if(l=!1,a=!1,n.target.parentNode===t[0])return u=!1,e.lastidx=e.idx,e.idx=Array.from(n.target.parentNode.childNodes).filter(function(e){return e.getAttribute&&/tick/.exec(e.getAttribute("class"))}).indexOf(n.target),e.idx<0?e.idx=null:(a=!0,n.preventDefault(),n.stopPropagation())})}),window.addEventListener("mousemove",function(n){return e.$apply(function(){var r,i,a,c;if(l=!0,r=t[0].getBoundingClientRect(),(i=(n.clientX-r.left)/r.width)<=1||(i=1),i>=0||(i=0),a=Math.abs(n.clientY-(r.top+r.height/2)),c=n.buttons||n.button,!u&&c&&null!=e.idx){if(o.toggle(!1),a>r.height/2+60)return e.model&&e.model.colors.splice(e.idx,1),e.idx=null,d();if(e.model)return e.idx>0&&e.model.colors[e.idx-1].pos>i&&(i=e.model.colors[e.idx-1].pos),e.idx<e.model.colors.length-1&&e.model.colors[e.idx+1].pos<i&&(i=e.model.colors[e.idx+1].pos),e.model.colors[e.idx].pos=i,d()}})}),d()}}})),x$.directive("ngClipboard",["$compile"].concat(function(e){return{restrict:"A",scope:{},link:function(e,t,n,r){var i,o;return i=new Clipboard(t[0],{target:function(){return document.querySelector(n.target)}}),(o=document.createElement("div")).setAttribute("class","hover-tip "+(n.dir||"top")),t[0].appendChild(o),i.on("success",function(){return t.addClass("copied"),o.innerText="copied",setTimeout(function(){return t.removeClass("copied")},1e3)}),i.on("error",function(){return t.addClass("copied"),o.innerText="Press Ctrl+C to Copy",setTimeout(function(){return t.removeClass("copied")},1e3)})}}})),x$.directive("ngDrop",["$compile"].concat(function(e){return{restrict:"A",scope:{swap:"&swap"},link:function(e,t,n,r){var i,o;return n.swap&&(i=e.swap()),o=function(e){return e.getAttribute("draggable")?e:e.parentNode},t[0].addEventListener("dragenter",function(e){return e.preventDefault()}),t[0].addEventListener("dragover",function(e){return e.preventDefault(),e.dataTransfer.dropEffect="move"}),t[0].addEventListener("dragstart",function(e){var t,n;return t=o(e.target),n=Array.from(t.parentNode.querySelectorAll("*[draggable=true]")).indexOf(t),e.dataTransfer.setData("text/plain",n)}),t[0].addEventListener("drop",function(e){var t,n,r;if(t=o(e.target),n=+e.dataTransfer.getData("text"),r=Array.from(t.parentNode.querySelectorAll("*[draggable=true]")).indexOf(t),n>=0&&r>=0&&i)return i(n,r)})}}})),x$.directive("ngPaypal",["$compile","global","$timeout","gautil"].concat(function(e,t,n,r){return{restrict:"A",scope:{model:"=ngModel",trackid:"@trackid",type:"@type",id:"@itemid",price:"@price",format:"@format"},link:function(e,i,o,l){var a,u,d;return a=document.createElement("div"),a.id="paypal-btn-"+Math.random().toString().substring(2),a.setAttribute("class","paypal-btn-inner"),u=document.createElement("div"),u.id="paypal-btn-"+Math.random().toString().substring(2)+"-loader",u.setAttribute("class","ld ld-ball ld-flip"),i[0].appendChild(a),i[0].appendChild(u),i.addClass("ld ld-over-inverse running"),e.paid=!1,e.$watch("model.list",function(t,n){var r;if(t!==n&&t&&t.length)return(r=t.filter(function(t){return t.type===e.type&&t.item===e.id}).length)?i.addClass("paid"):i.removeClass("paid"),e.paid=!!r},!0),i.on("click",function(){if(e.paid)return e.model.paid({trackid:e.trackid,id:e.id,type:e.type,price:e.price,format:e.format})}),(d={init:function(){if(!this.inited)return"undefined"==typeof paypal||null===paypal?n(function(){return d.init()},1e3):(this.inited=!0,paypal.Button.render({env:t.production?"production":"sandbox",style:{size:"responsive"},payment:function(n,i){return r.track(e.trackid,"pay-button","click"),paypal.request.post("/d/create-payment/",{type:e.type,id:e.id},{headers:{"X-CSRF-Token":t.csrfToken}}).then(function(e){return n(e.paymentID)}).catch(function(e){return i(e)})},onAuthorize:function(n){var i;return paypal.request.post("/d/execute-payment/",(i={paymentID:n.paymentID,payerID:n.payerID},i.type=e.type,i.id=e.id,i),{headers:{"X-CSRF-Token":t.csrfToken}}).then(function(t){return e.$apply(function(){if(null!=e.model.paid)return e.model.paid({trackid:e.trackid,id:e.id,type:e.type,price:e.price,format:e.format})}),r.track(e.trackid,"paid",e.format||"",1.99),null}).catch(function(e){return console.log(e),alert("Something wrong in the payment process. please try again.")})}},a.id).then(function(){return i.removeClass("running")}))}}).init()}}}));