function import$(e,t){var n,r={}.hasOwnProperty;for(n in t)r.call(t,n)&&(e[n]=t[n]);return e}$(document).ready(function(){var s,t=Array.from(document.querySelectorAll(".reveal")),n=document.createElement("div"),r=document.createElement("div");return n.setAttribute("class","reveal-shadow"),document.body.appendChild(n),n.appendChild(r),n.addEventListener("click",function(){return import$(import$(n.style,n.source),{opacity:0,zIndex:-1})}),Array.from(document.querySelectorAll(".lightbox")).map(function(t){return t.addEventListener("click",function(){var e=t.getBoundingClientRect();return n.setAttribute("class","reveal-shadow"),n.box=e,n.source={width:e.width+"px",height:e.height+"px",top:e.top+"px",left:e.left+"px",zIndex:9999},import$(n.style,n.source),r.style.backgroundImage="url("+(t.getAttribute("data-lg-src")||t.getAttribute("data-src"))+")",setTimeout(function(){return n.setAttribute("class","reveal-shadow active"),import$(n.style,{width:"100%",height:"100%",top:"0",left:"0",opacity:1})},10)})}),window.addEventListener("scroll",function(){var e=window.innerHeight;window.pageYOffset;return t.map(function(t){if(t.getBoundingClientRect().top<.8*e&&!t.revealed)return t.revealed=!0,t.node=new Image,t.node.onload=function(){return setTimeout(function(){var e;return t.style.backgroundImage="url("+(t.getAttribute("data-src")||"")+")",~(e=t.getAttribute("class").split(" ")).indexOf("on")||e.push("on"),t.setAttribute("class",e.join(" "))},200*Math.random())},t.node.src=t.getAttribute("data-src")||""})}),window.scrollto=function(e,n){var r,o,i,u,c;return null==n&&(n=500),r=document.documentElement||document.body,e=[(e="string"==typeof e?document.querySelector(e):e).getBoundingClientRect().top,window.pageYOffset],i=(e=[e[0]-(o=e[1]),-1])[0],u=e[1],c=function(e){var t=s(e-(u=u<0?e:u),o,i,n);if(r.scrollTop=t,e<=u+n)return requestAnimationFrame(c)},requestAnimationFrame(c)},s=function(e,t,n,r){return(e/=.5*r)<1?.5*n*e*e+t:.5*-n*((e-=1)*(e-2)-1)+t},window.search=function(){var i,e,n;return document.body.setAttribute("class",document.body.getAttribute("class")+" running"),(i=(document.getElementById("search-input")||{}).value||"")||(e=/q=(.+)/.exec(window.location.search))&&(i=e[1]),i&&!/search/.exec(window.location.href)&&(window.location.href="/search/?q="+i),i&&(i=decodeURIComponent(i),document.querySelector("#search-hint").innerText="搜尋「"+i+"」的搜尋結果"),e={query:{query_string:{query:i}},from:0,highlight:{fields:{content:{}}},aggs:{source_count:{terms:{field:"source"}}},sort:[{updated_at:"desc"}]},e="https://api.search.g0v.io/query.php?query="+encodeURIComponent(JSON.stringify(e)),(n=new XMLHttpRequest).addEventListener("load",function(){var e=JSON.parse(n.responseText).hits.hits.map(function(e){var e={title:(e=e._source).title,url:e.url,content:e.content,source:e.source},t=e.title,n=e.url,r=e.content,o=e.source;return t=(e=[t,n,r=100<r.length?r.substring(0,100)+"...":r].map(function(e){return e.replace(/[<>\&]/gim,function(e){return"&#"+e.charCodeAt(0)+";"})}))[0],'<div class="search-result"><a href="'+(n=e[1])+'">'+t+"</a><div class='url'>"+n+"</div><div class='desc'>"+(r=(r=e[2]).replace(new RegExp(i+"","g"),function(){return"<b>"+i+"</b>"}))+"</div><div class='type'>"+o+"</div></div>"}),t=document.querySelector(".search-results");if(t)return t.innerHTML=e.join(""),document.body.setAttribute("class",document.body.getAttribute("class").replace("running",""))}),n.open("GET",e),n.send()}});