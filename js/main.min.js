function import$(e,t){var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}$(document).ready(function(){var e,t,n,r;return e=Array.from(document.querySelectorAll(".reveal")),t=document.createElement("div"),n=document.createElement("div"),t.setAttribute("class","reveal-shadow"),document.body.appendChild(t),t.appendChild(n),t.addEventListener("click",function(){return import$(import$(t.style,t.source),{opacity:0,zIndex:-1})}),Array.from(document.querySelectorAll(".lightbox")).map(function(e){return e.addEventListener("click",function(){var r;return r=e.getBoundingClientRect(),t.setAttribute("class","reveal-shadow"),t.box=r,t.source={width:r.width+"px",height:r.height+"px",top:r.top+"px",left:r.left+"px",zIndex:9999},import$(t.style,t.source),n.style.backgroundImage="url("+(e.getAttribute("data-lg-src")||e.getAttribute("data-src"))+")",setTimeout(function(){return t.setAttribute("class","reveal-shadow active"),import$(t.style,{width:"100%",height:"100%",top:"0",left:"0",opacity:1})},10)})}),window.addEventListener("scroll",function(){var t;return t=window.innerHeight,window.pageYOffset,e.map(function(e){if(e.getBoundingClientRect().top<.8*t&&!e.revealed)return e.revealed=!0,e.node=new Image,e.node.onload=function(){return setTimeout(function(){var t;return e.style.backgroundImage="url("+(e.getAttribute("data-src")||"")+")",~(t=e.getAttribute("class").split(" ")).indexOf("on")||t.push("on"),e.setAttribute("class",t.join(" "))},200*Math.random())},e.node.src=e.getAttribute("data-src")||""})}),window.scrollto=function(e,t){var n,o,i,u,c,s,a;return null==t&&(t=500),n=document.documentElement||document.body,"string"==typeof e&&(e=document.querySelector(e)),o=[e.getBoundingClientRect().top,window.pageYOffset],i=o[0],u=o[1],o=[i-u,-1],c=o[0],s=o[1],a=function(e){var o;if(s<0&&(s=e),o=r(e-s,u,c,t),n.scrollTop=o,e<=s+t)return requestAnimationFrame(a)},requestAnimationFrame(a)},r=function(e,t,n,r){return(e/=.5*r)<1?.5*n*e*e+t:(e-=1,.5*-n*(e*(e-2)-1)+t)},window.search=function(){var e,t,n,r,o;return document.body.setAttribute("class",document.body.getAttribute("class")+" running"),(e=(document.getElementById("search-input")||{}).value||"")||(t=/q=(.+)/.exec(window.location.search))&&(e=t[1]),e&&!/search/.exec(window.location.href)&&(window.location.href="/search/?q="+e),e&&(e=decodeURIComponent(e),document.querySelector("#search-hint").innerText="搜尋「"+e+"」的搜尋結果"),n={query:{query_string:{query:e}},from:0,highlight:{fields:{content:{}}},aggs:{source_count:{terms:{field:"source"}}},sort:[{updated_at:"desc"}]},r="https://api.search.g0v.io/query.php?query="+encodeURIComponent(JSON.stringify(n)),(o=new XMLHttpRequest).addEventListener("load",function(){var t,n,r;if(t=JSON.parse(o.responseText),n=t.hits.hits.map(function(t){var n,r,o,i,u;return n={title:(n=t._source).title,url:n.url,content:n.content,source:n.source},r=n.title,o=n.url,i=n.content,u=n.source,i.length>100&&(i=i.substring(0,100)+"..."),n=[r,o,i].map(function(e){return e.replace(/[<>\&]/gim,function(e){return"&#"+e.charCodeAt(0)+";"})}),r=n[0],o=n[1],i=n[2],i=i.replace(new RegExp(e+"","g"),function(){return"<b>"+e+"</b>"}),'<div class="search-result"><a href="'+o+'">'+r+"</a><div class='url'>"+o+"</div><div class='desc'>"+i+"</div><div class='type'>"+u+"</div></div>"}),r=document.querySelector(".search-results"))return r.innerHTML=n.join(""),document.body.setAttribute("class",document.body.getAttribute("class").replace("running",""))}),o.open("GET",r),o.send()}});